<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MANZIL PROJECTS - Saudi Real Estate Management</title>
    <style>
        /* Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        
        /* Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #00a86b;
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: none;
            max-width: 300px;
        }
        
        .notification.error {
            background: #ff6b6b;
        }
        
        .notification.warning {
            background: #ff9900;
        }
        
        .sync-status {
            position: fixed;
            bottom: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.8rem;
            z-index: 100;
        }
        
        .auto-save-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #00a86b;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
    </style>
</head>
<body>
    <!-- Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª -->
    <div class="notification" id="notification"></div>
    <div class="sync-status" id="syncStatus">Auto-save: ON</div>
    
    <div class="container">
        <header>
            <h1>MANZIL PROJECTS</h1>
            <p class="project-info">Manage all your real estate projects in Saudi cities</p>
            <div style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">
                <span id="lastSaved">Last saved: Never</span>
            </div>
        </header>
        
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© -->
        <div class="auth-panel" id="authPanel">
            <h2 class="auth-title">ğŸ” Authentication Required</h2>
            <p>Enter password to enable editing features</p>
            <input type="password" class="auth-input" id="passwordInput" placeholder="Enter password">
            <button class="auth-btn" id="authBtn">Authenticate</button>
            <div class="auth-message" id="authMessage"></div>
            <div class="auto-save-toggle">
                <span>Auto-save:</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="autoSaveToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
        
        <!-- Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ -->
        
    </div>
    
    <!-- ØªÙˆÙ‚ÙŠØ¹ Ahmed Mokhtar -->
    <div class="signature">
        By: <span>Ahmed Mokhtar | Operations Team 2025 Â© </span>
    </div>

    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
        let cities = [
            {
                id: 1,
                name: "Riyadh",
                totalProjects: 27,
                color: "riyadh",
                description: "The capital and largest city of Saudi Arabia"
            },
            {
                id: 2,
                name: "Jeddah", 
                totalProjects: 11,
                color: "jeddah",
                description: "Major urban center and port on the Red Sea"
            },
            {
                id: 3,
                name: "Dammam",
                totalProjects: 4,
                color: "dammam",
                description: "Capital of the Eastern Province and important port city"
            }
        ];

        let projectGroups = {
            riyadh: [
                {
                    id: 1,
                    name: "SLY",
                    description: "AS SULY PROJECTS",
                    totalProjects: 5,
                    totalBeds: 0,
                    centralKitchen: true,
                    type: "sly"
                },
                {
                    id: 2,
                    name: "UMH", 
                    description: "UMM AL HAMMAM PROJECTS",
                    totalProjects: 7,
                    totalBeds: 0,
                    centralKitchen: false,
                    type: "umh"
                }
            ],
            jeddah: [
                {
                    id: 1,
                    name: "HAM",
                    description: "Al Hamadaniyyah Projects",
                    totalProjects: 1,
                    totalBeds: 0,
                    centralKitchen: false,
                    type: "ham"
                }
            ],
            dammam: [
                {
                    id: 1,
                    name: "KJH",
                    description: "Al Khalidiyyah Al Janubiyyah Projects",
                    totalProjects: 2,
                    totalBeds: 0,
                    centralKitchen: false,
                    type: "kjh"
                }
            ]
        };

        let projects = {
            sly: [
                {
                    id: 1,
                    name: "SLY-1001",
                    location: "Riyadh - Al Sulay District",
                    totalApartments: 35,
                    totalBathrooms: 68,
                    totalBeds: 0,
                    centralKitchen: true,
                    floors: ["Ground Floor", "First Floor", "Second Floor"],
                    apartments: []
                },
                {
                    id: 2,
                    name: "SLY-1002", 
                    location: "Riyadh - Al Sulay District",
                    totalApartments: 19,
                    totalBathrooms: 38,
                    totalBeds: 0,
                    centralKitchen: true,
                    floors: ["Ground Floor", "First Floor", "Second Floor"],
                    apartments: []
                }
            ],
            umh: [
                {
                    id: 3,
                    name: "UMH-1003",
                    location: "Riyadh - Umm Al Hamam District", 
                    totalApartments: 14,
                    totalBathrooms: 28,
                    totalBeds: 0,
                    centralKitchen: false,
                    floors: ["Ground Floor", "First Floor", "Second Floor"],
                    apartments: []
                }
            ]
        };

        // DOM Elements
        const citiesPage = document.getElementById('citiesPage');
        const projectGroupsPage = document.getElementById('projectGroupsPage');
        const projectsPage = document.getElementById('projectsPage');
        const apartmentsPage = document.getElementById('apartmentsPage');
        const citiesContainer = document.getElementById('citiesContainer');
        const projectGroupsContainer = document.getElementById('projectGroupsContainer');
        const projectsContainer = document.getElementById('projectsContainer');
        const floorsContainer = document.getElementById('floorsContainer');
        const floorManagement = document.getElementById('floorManagement');
        const floorList = document.getElementById('floorList');
        const newFloorName = document.getElementById('newFloorName');
        const addFloorBtn = document.getElementById('addFloorBtn');
        const backToCities = document.getElementById('backToCities');
        const backToProjectGroups = document.getElementById('backToProjectGroups');
        const backToProjects = document.getElementById('backToProjects');
        const cityTitle = document.getElementById('cityTitle');
        const cityDetails = document.getElementById('cityDetails');
        const groupTitle = document.getElementById('groupTitle');
        const groupDetails = document.getElementById('groupDetails');
        const projectTitle = document.getElementById('projectTitle');
        const projectDetails = document.getElementById('projectDetails');
        const apartmentDetails = document.getElementById('apartmentDetails');
        const detailsTitle = document.getElementById('detailsTitle');
        const detailsContent = document.getElementById('detailsContent');
        const closeDetails = document.getElementById('closeDetails');
        const breadcrumb = document.getElementById('breadcrumb');
        const totalCities = document.getElementById('totalCities');
        const totalProjects = document.getElementById('totalProjects');
        const totalApartments = document.getElementById('totalApartments');
        const totalBeds = document.getElementById('totalBeds');

        // Ø¹Ù†Ø§ØµØ± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
        const authPanel = document.getElementById('authPanel');
        const passwordInput = document.getElementById('passwordInput');
        const authBtn = document.getElementById('authBtn');
        const authMessage = document.getElementById('authMessage');
        const adminPanel = document.getElementById('adminPanel');
        const addCity = document.getElementById('addCity');
        const addGroup = document.getElementById('addGroup');
        const addProject = document.getElementById('addProject');
        const saveData = document.getElementById('saveData');
        const loadData = document.getElementById('loadData');
        const cityForm = document.getElementById('cityForm');
        const groupForm = document.getElementById('groupForm');
        const projectForm = document.getElementById('projectForm');
        const saveCity = document.getElementById('saveCity');
        const cancelCity = document.getElementById('cancelCity');
        const saveGroup = document.getElementById('saveGroup');
        const cancelGroup = document.getElementById('cancelGroup');
        const saveProject = document.getElementById('saveProject');
        const cancelProject = document.getElementById('cancelProject');

        // Ø¹Ù†Ø§ØµØ± Ø¬Ø¯ÙŠØ¯Ø©
        const notification = document.getElementById('notification');
        const syncStatus = document.getElementById('syncStatus');
        const lastSaved = document.getElementById('lastSaved');
        const autoSaveToggle = document.getElementById('autoSaveToggle');
        const exportData = document.getElementById('exportData');
        const importData = document.getElementById('importData');

        // Current navigation state
        let currentCity = null;
        let currentGroup = null;
        let currentProject = null;
        let editMode = false;
        let autoSaveEnabled = true;
        const PASSWORD = "888";

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
        function authenticate() {
            const password = passwordInput.value;
            
            if (password === PASSWORD) {
                editMode = true;
                authPanel.classList.add('hidden');
                adminPanel.classList.remove('hidden');
                authMessage.textContent = '';
                passwordInput.value = '';
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ø¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
                if (!citiesPage.classList.contains('hidden')) {
                    renderCities();
                } else if (!projectGroupsPage.classList.contains('hidden')) {
                    renderProjectGroups(currentCity);
                } else if (!projectsPage.classList.contains('hidden')) {
                    renderProjects(currentGroup);
                } else if (!apartmentsPage.classList.contains('hidden')) {
                    renderApartments(currentProject);
                }
                
                showNotification('Authentication successful! Editing features are now enabled.', 'success');
            } else {
                authMessage.textContent = 'Incorrect password. Please try again.';
                passwordInput.value = '';
                showNotification('Incorrect password. Please try again.', 'error');
            }
        }

        // ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = 'notification';
            if (type === 'error') {
                notification.classList.add('error');
            } else if (type === 'warning') {
                notification.classList.add('warning');
            }
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        // ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø­ÙØ¸
        function updateLastSaved() {
            const now = new Date();
            lastSaved.textContent = `Last saved: ${now.toLocaleString()}`;
        }

        // ÙˆØ¸ÙŠÙØ© Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
        function saveToLocalStorage() {
            if (!autoSaveEnabled) return;
            
            try {
                const appData = {
                    cities: cities,
                    projectGroups: projectGroups,
                    projects: projects,
                    lastUpdated: new Date().toISOString()
                };
                localStorage.setItem('manzilProjectsData', JSON.stringify(appData));
                updateLastSaved();
                showNotification('Data saved successfully!', 'success');
            } catch (error) {
                console.error('Error saving data:', error);
                showNotification('Error saving data!', 'error');
            }
        }

        // ÙˆØ¸ÙŠÙØ© ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function exportAppData() {
            const appData = {
                cities: cities,
                projectGroups: projectGroups,
                projects: projects,
                exportedAt: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `manzil-projects-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('Data exported successfully!', 'success');
        }

        // ÙˆØ¸ÙŠÙØ© Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function importAppData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (confirm('Are you sure you want to import this data? This will replace all current data.')) {
                        cities = importedData.cities || cities;
                        projectGroups = importedData.projectGroups || projectGroups;
                        projects = importedData.projects || projects;
                        
                        initializeStats();
                        showCitiesPage();
                        saveToLocalStorage();
                        
                        showNotification('Data imported successfully!', 'success');
                    }
                } catch (error) {
                    console.error('Error importing data:', error);
                    showNotification('Error importing data! Invalid file format.', 'error');
                }
            };
            reader.readAsText(file);
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù†ÙØ³ Ø§Ù„Ù…Ù„Ù Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
            event.target.value = '';
        }

        // ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­ÙØ¸
        function toggleAutoSave() {
            autoSaveEnabled = !autoSaveEnabled;
            autoSaveToggle.checked = autoSaveEnabled;
            syncStatus.textContent = `Auto-save: ${autoSaveEnabled ? 'ON' : 'OFF'}`;
            syncStatus.style.background = autoSaveEnabled ? 'rgba(0, 168, 107, 0.8)' : 'rgba(255, 107, 107, 0.8)';
            
            showNotification(`Auto-save ${autoSaveEnabled ? 'enabled' : 'disabled'}`, 
                           autoSaveEnabled ? 'success' : 'warning');
        }

        // Initialize statistics
        function initializeStats() {
            totalCities.textContent = cities.length;
            
            let totalProjectsCount = 0;
            let totalApartmentsCount = 0;
            let totalBedsCount = 0;
            
            // Calculate totals
            for (const city in projectGroups) {
                projectGroups[city].forEach(group => {
                    totalProjectsCount += group.totalProjects;
                });
            }
            
            for (const group in projects) {
                projects[group].forEach(project => {
                    totalApartmentsCount += project.totalApartments;
                    totalBedsCount += project.totalBeds;
                });
            }
            
            totalProjects.textContent = totalProjectsCount;
            totalApartments.textContent = totalApartmentsCount;
            totalBeds.textContent = totalBedsCount;
        }

        // Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© saveToLocalStorage() Ø¨Ø¹Ø¯ ÙƒÙ„ ØªØ¹Ø¯ÙŠÙ„
        
        // Event Listeners
        backToCities.addEventListener('click', showCitiesPage);
        backToProjectGroups.addEventListener('click', () => {
            if (currentCity) {
                showCityProjectGroups(currentCity);
            }
        });
        backToProjects.addEventListener('click', () => {
            if (currentCity && currentGroup) {
                showGroupProjects(currentGroup, currentCity.name);
            }
        });
        closeDetails.addEventListener('click', () => {
            apartmentDetails.style.display = 'none';
        });

        // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
        authBtn.addEventListener('click', authenticate);
        passwordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                authenticate();
            }
        });

        // Ø£Ø­Ø¯Ø§Ø« Ø¬Ø¯ÙŠØ¯Ø©
        autoSaveToggle.addEventListener('change', toggleAutoSave);
        exportData.addEventListener('click', exportAppData);
        importData.addEventListener('click', () => {
            document.getElementById('importFile').click();
        });

        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø¥Ø¯Ø®Ø§Ù„ Ù…Ù„Ù Ù…Ø®ÙÙŠ Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const importFileInput = document.createElement('input');
        importFileInput.type = 'file';
        importFileInput.accept = '.json';
        importFileInput.id = 'importFile';
        importFileInput.style.display = 'none';
        importFileInput.addEventListener('change', importAppData);
        document.body.appendChild(importFileInput);

        // Initialize
        initializeStats();
        showCitiesPage();

        // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        window.addEventListener('load', () => {
            const savedData = localStorage.getItem('manzilProjectsData');
            if (savedData) {
                try {
                    const appData = JSON.parse(savedData);
                    cities = appData.cities || cities;
                    projectGroups = appData.projectGroups || projectGroups;
                    projects = appData.projects || projects;
                    
                    if (appData.lastUpdated) {
                        lastSaved.textContent = `Last saved: ${new Date(appData.lastUpdated).toLocaleString()}`;
                    }
                    
                    initializeStats();
                    renderCities();
                    showNotification('Data loaded successfully!', 'success');
                } catch (error) {
                    console.log('Error loading saved data:', error);
                    showNotification('Error loading saved data!', 'error');
                }
            }
        });

        // Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', () => {
            if (editMode && autoSaveEnabled) {
                saveToLocalStorage();
            }
        });

        console.log('MANZIL PROJECTS System initialized successfully!');
    </script>
</body>
</html>